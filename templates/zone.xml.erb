<?xml version="1.0" encoding="utf-8"?>
<% if (defined? @zonevalues) -%>
<% if (defined? @zonevalues["target"]) and 
       (['ACCEPT','default','DROP','REJECTED'].include? @zonevalues["target"]) -%>
<zone target="<%= @zonevalues["target"] -%>">
<% else -%>
<zone>
<% end -%>
  <short><%= @zone %></short>
<% if @zonevalues["sources"] -%>
<% @zonevalues["sources"].each do |source| -%>
  <source address="<%= source %>" />
<% end -%>
<% end -%>
<% if @zonevalues["services"] -%>
<% @zonevalues["services"].each do |service| -%>
  <service name="<%= service %>" />
<% end -%>
<% end -%>
<% if @zonevalues["ports"] -%>
<% @zonevalues["ports"].each do |number, protocol| -%>
  <port port="<%= number %>" protocol="<%= protocol %>" />
<% end -%>
<% end -%>
<% if @zonevalues["rich_rules"] -%>
<% @zonevalues["rich_rules"].each do |rule, rulevalues| -%>
  <rule family="ipv4">
<% if rulevalues["ipset"] -%>
    <source ipset="<%= rulevalues["ipset"] %>" />
<% end -%>
<% if rulevalues["service"] -%>
    <service name="<%= rulevalues["service"] %>" />
<% end -%>
    <accept/>
  </rule>
<% end -%>
<% end -%>
<% else -%>
<zone>
  <short><%= @zone %></short>
<% end -%>
</zone>
